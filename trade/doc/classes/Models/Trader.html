<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: Models::Trader</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">Models::Trader</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../files/app/models/module/trader_rb.html">
                app/models/module/trader.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                Object
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
Abstract class for trading offers in the System. Do not try to create a
trader directly, known subclasses are: <a href="User.html">User</a>,
Organisation Traders have a name. Traders have an amount of credits. A <a
href="Trader.html#M000112">new</a> trader has originally 100 credit. A
trader can add a <a href="Trader.html#M000112">new</a> item to the system
with a name and a price; the item is originally inactive. A trader provides
a method that lists his/her active items to sell. <a
href="Trader.html">Trader</a> possesses certain offers A trader can buy
active offers of another trader.
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000137">&lt;=&gt;</a>&nbsp;&nbsp;
      <a href="#M000120">activate_item</a>&nbsp;&nbsp;
      <a href="#M000136">add_offer</a>&nbsp;&nbsp;
      <a href="#M000133">add_rating</a>&nbsp;&nbsp;
      <a href="#M000131">add_to_wishlist</a>&nbsp;&nbsp;
      <a href="#M000123">answer_comment</a>&nbsp;&nbsp;
      <a href="#M000126">available?</a>&nbsp;&nbsp;
      <a href="#M000119">buy_new_item</a>&nbsp;&nbsp;
      <a href="#M000113">by_name</a>&nbsp;&nbsp;
      <a href="#M000127">clear_all</a>&nbsp;&nbsp;
      <a href="#M000122">comment_item</a>&nbsp;&nbsp;
      <a href="#M000115">create_item</a>&nbsp;&nbsp;
      <a href="#M000124">deactivate_item</a>&nbsp;&nbsp;
      <a href="#M000130">delete</a>&nbsp;&nbsp;
      <a href="#M000121">edit_item</a>&nbsp;&nbsp;
      <a href="#M000141">get_activities</a>&nbsp;&nbsp;
      <a href="#M000125">get_all</a>&nbsp;&nbsp;
      <a href="#M000140">get_watching_logs</a>&nbsp;&nbsp;
      <a href="#M000117">list_auctions</a>&nbsp;&nbsp;
      <a href="#M000116">list_items</a>&nbsp;&nbsp;
      <a href="#M000118">list_items_inactive</a>&nbsp;&nbsp;
      <a href="#M000112">new</a>&nbsp;&nbsp;
      <a href="#M000128">pending_inbox</a>&nbsp;&nbsp;
      <a href="#M000129">pending_outbox</a>&nbsp;&nbsp;
      <a href="#M000134">rating</a>&nbsp;&nbsp;
      <a href="#M000132">remove_from_wishlist</a>&nbsp;&nbsp;
      <a href="#M000135">remove_offer</a>&nbsp;&nbsp;
      <a href="#M000114">save</a>&nbsp;&nbsp;
      <a href="#M000139">unwatch</a>&nbsp;&nbsp;
      <a href="#M000138">watch</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">activities</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
[Array]: all activites of this user or users of this organization

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">credits</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
[Integer]: The owned money in credits

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">description</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
[String]: List interests or other things about this owner

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">e_mail</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">errors</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
[String]: Stores all error messages

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">id</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
[Integer]

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">image</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
[String]: The path of an image

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">name</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
[String]

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">offers</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
[Array]: All the offers the trader possesses

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">organization</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
[Boolean]: check if trader is an organization, used primarily for views

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">ratings</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
[Array]: Ratings of other users

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">wallet</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">watching</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
[Array]: list of traders that are being followed

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">wishlist</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
[Array]: All the offers, this user is interested in

</td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000126" class="method-detail">
        <a name="M000126"></a>

        <div class="method-heading">
          <a href="Trader.src/M000126.html" target="Code" class="method-signature"
            onclick="popupCode('Trader.src/M000126.html');return false;">
          <span class="method-name">available?</span><span class="method-args">(name)</span>
          </a>
        </div>
      
        <div class="method-description">
          <ul>
<li>@return true, if the given name is the name of an existing user

</li>
</ul>
        </div>
      </div>

      <div id="method-M000113" class="method-detail">
        <a name="M000113"></a>

        <div class="method-heading">
          <a href="Trader.src/M000113.html" target="Code" class="method-signature"
            onclick="popupCode('Trader.src/M000113.html');return false;">
          <span class="method-name">by_name</span><span class="method-args">(name)</span>
          </a>
        </div>
      
        <div class="method-description">
          <ul>
<li>@return [<a href="User.html">User</a>]: the user with the given username

</li>
</ul>
        </div>
      </div>

      <div id="method-M000127" class="method-detail">
        <a name="M000127"></a>

        <div class="method-heading">
          <a href="Trader.src/M000127.html" target="Code" class="method-signature"
            onclick="popupCode('Trader.src/M000127.html');return false;">
          <span class="method-name">clear_all</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000125" class="method-detail">
        <a name="M000125"></a>

        <div class="method-heading">
          <a href="Trader.src/M000125.html" target="Code" class="method-signature"
            onclick="popupCode('Trader.src/M000125.html');return false;">
          <span class="method-name">get_all</span><span class="method-args">(viewer)</span>
          </a>
        </div>
      
        <div class="method-description">
          <ul>
<li>@return [Array]: all users except the given viewer

</li>
</ul>
        </div>
      </div>

      <div id="method-M000112" class="method-detail">
        <a name="M000112"></a>

        <div class="method-heading">
          <a href="Trader.src/M000112.html" target="Code" class="method-signature"
            onclick="popupCode('Trader.src/M000112.html');return false;">
          <span class="method-name">new</span><span class="method-args">(name, description, image)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000137" class="method-detail">
        <a name="M000137"></a>

        <div class="method-heading">
          <a href="Trader.src/M000137.html" target="Code" class="method-signature"
            onclick="popupCode('Trader.src/M000137.html');return false;">
          <span class="method-name">&lt;=&gt;</span><span class="method-args">(o)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000120" class="method-detail">
        <a name="M000120"></a>

        <div class="method-heading">
          <a href="Trader.src/M000120.html" target="Code" class="method-signature"
            onclick="popupCode('Trader.src/M000120.html');return false;">
          <span class="method-name">activate_item</span><span class="method-args">(id)</span>
          </a>
        </div>
      
        <div class="method-description">
          <ul>
<li>@param [Integer] id: The offers ID

</li>
</ul>
        </div>
      </div>

      <div id="method-M000136" class="method-detail">
        <a name="M000136"></a>

        <div class="method-heading">
          <a href="Trader.src/M000136.html" target="Code" class="method-signature"
            onclick="popupCode('Trader.src/M000136.html');return false;">
          <span class="method-name">add_offer</span><span class="method-args">(offer)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000133" class="method-detail">
        <a name="M000133"></a>

        <div class="method-heading">
          <a href="Trader.src/M000133.html" target="Code" class="method-signature"
            onclick="popupCode('Trader.src/M000133.html');return false;">
          <span class="method-name">add_rating</span><span class="method-args">(rating)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000131" class="method-detail">
        <a name="M000131"></a>

        <div class="method-heading">
          <a href="Trader.src/M000131.html" target="Code" class="method-signature"
            onclick="popupCode('Trader.src/M000131.html');return false;">
          <span class="method-name">add_to_wishlist</span><span class="method-args">(offer)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000123" class="method-detail">
        <a name="M000123"></a>

        <div class="method-heading">
          <a href="Trader.src/M000123.html" target="Code" class="method-signature"
            onclick="popupCode('Trader.src/M000123.html');return false;">
          <span class="method-name">answer_comment</span><span class="method-args">(comment, text)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Invokes the answer method of a comment and logs this activity to the
traders log.
</p>
        </div>
      </div>

      <div id="method-M000119" class="method-detail">
        <a name="M000119"></a>

        <div class="method-heading">
          <a href="Trader.src/M000119.html" target="Code" class="method-signature"
            onclick="popupCode('Trader.src/M000119.html');return false;">
          <span class="method-name">buy_new_item</span><span class="method-args">(item_to_buy, quantity, account)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
When a trader buys an item, it becomes the owner; credit are transferred
accordingly; immediately after the trade, the item is inactive. The
transaction fails if the buyer has not enough credits.
</p>
<ul>
<li>@param item_to_buy

</li>
<li>@param quantity: how many pieces of this item should be bought

</li>
<li>@return true if user can buy the offer, false if his credit amount is too
small

</li>
</ul>
        </div>
      </div>

      <div id="method-M000122" class="method-detail">
        <a name="M000122"></a>

        <div class="method-heading">
          <a href="Trader.src/M000122.html" target="Code" class="method-signature"
            onclick="popupCode('Trader.src/M000122.html');return false;">
          <span class="method-name">comment_item</span><span class="method-args">(item, text)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Invokes the comment method of an item and logs this activity to the traders
log.
</p>
        </div>
      </div>

      <div id="method-M000115" class="method-detail">
        <a name="M000115"></a>

        <div class="method-heading">
          <a href="Trader.src/M000115.html" target="Code" class="method-signature"
            onclick="popupCode('Trader.src/M000115.html');return false;">
          <span class="method-name">create_item</span><span class="method-args">(name, price, quantity, description=&quot;No description available&quot;, image=&quot;&quot;)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Lets the trader create a <a href="Trader.html#M000112">new</a> item
</p>
<ul>
<li>@param name

</li>
<li>@param price

</li>
<li>@param quantity

</li>
<li>@param description

</li>
<li>@param image

</li>
<li>@return [<a href="Item.html">Item</a>]: the created item

</li>
</ul>
        </div>
      </div>

      <div id="method-M000124" class="method-detail">
        <a name="M000124"></a>

        <div class="method-heading">
          <a href="Trader.src/M000124.html" target="Code" class="method-signature"
            onclick="popupCode('Trader.src/M000124.html');return false;">
          <span class="method-name">deactivate_item</span><span class="method-args">(id)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Deactivates an item, removes it from everybody&#8216;s wishlist and sets
expiration_date to nil
</p>
<ul>
<li>@param [Integer] id: The <a href="Item.html">Item</a>&#8216;s id

</li>
</ul>
        </div>
      </div>

      <div id="method-M000130" class="method-detail">
        <a name="M000130"></a>

        <div class="method-heading">
          <a href="Trader.src/M000130.html" target="Code" class="method-signature"
            onclick="popupCode('Trader.src/M000130.html');return false;">
          <span class="method-name">delete</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Deletes the trader from the system and removes all his offers.
</p>
        </div>
      </div>

      <div id="method-M000121" class="method-detail">
        <a name="M000121"></a>

        <div class="method-heading">
          <a href="Trader.src/M000121.html" target="Code" class="method-signature"
            onclick="popupCode('Trader.src/M000121.html');return false;">
          <span class="method-name">edit_item</span><span class="method-args">(item, name, price, quantity, currency, description = &quot;&quot;, image = &quot;&quot;)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Invokes the edit method of an item and logs this activity to the traders
log.
</p>
        </div>
      </div>

      <div id="method-M000141" class="method-detail">
        <a name="M000141"></a>

        <div class="method-heading">
          <a href="Trader.src/M000141.html" target="Code" class="method-signature"
            onclick="popupCode('Trader.src/M000141.html');return false;">
          <span class="method-name">get_activities</span><span class="method-args">(filter = Array.new)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns activities of the types given in the filter array. If the Array is
empty, the method returns all activities of this user.
</p>
        </div>
      </div>

      <div id="method-M000140" class="method-detail">
        <a name="M000140"></a>

        <div class="method-heading">
          <a href="Trader.src/M000140.html" target="Code" class="method-signature"
            onclick="popupCode('Trader.src/M000140.html');return false;">
          <span class="method-name">get_watching_logs</span><span class="method-args">(filter = [&quot;add_item&quot;, &quot;edit_item&quot;, &quot;activate_item&quot;, &quot;deactivate_item&quot;])</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000117" class="method-detail">
        <a name="M000117"></a>

        <div class="method-heading">
          <a href="Trader.src/M000117.html" target="Code" class="method-signature"
            onclick="popupCode('Trader.src/M000117.html');return false;">
          <span class="method-name">list_auctions</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <ul>
<li>@return [Array]: All the trader&#8216;s auctions

</li>
</ul>
        </div>
      </div>

      <div id="method-M000116" class="method-detail">
        <a name="M000116"></a>

        <div class="method-heading">
          <a href="Trader.src/M000116.html" target="Code" class="method-signature"
            onclick="popupCode('Trader.src/M000116.html');return false;">
          <span class="method-name">list_items</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Return a list of the trader&#8216;s active items
</p>
<ul>
<li>@return [Array]: The traders active items

</li>
</ul>
        </div>
      </div>

      <div id="method-M000118" class="method-detail">
        <a name="M000118"></a>

        <div class="method-heading">
          <a href="Trader.src/M000118.html" target="Code" class="method-signature"
            onclick="popupCode('Trader.src/M000118.html');return false;">
          <span class="method-name">list_items_inactive</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Return a list of the trader&#8216;s inactive items
</p>
<ul>
<li>@return [Array] The trader&#8216;s inactive items

</li>
</ul>
        </div>
      </div>

      <div id="method-M000128" class="method-detail">
        <a name="M000128"></a>

        <div class="method-heading">
          <a href="Trader.src/M000128.html" target="Code" class="method-signature"
            onclick="popupCode('Trader.src/M000128.html');return false;">
          <span class="method-name">pending_inbox</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <ul>
<li>@return [Array]: all the pending items to buy of this user

</li>
</ul>
        </div>
      </div>

      <div id="method-M000129" class="method-detail">
        <a name="M000129"></a>

        <div class="method-heading">
          <a href="Trader.src/M000129.html" target="Code" class="method-signature"
            onclick="popupCode('Trader.src/M000129.html');return false;">
          <span class="method-name">pending_outbox</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <ul>
<li>@return [Array]: all the pending items to sell of this user

</li>
</ul>
        </div>
      </div>

      <div id="method-M000134" class="method-detail">
        <a name="M000134"></a>

        <div class="method-heading">
          <a href="Trader.src/M000134.html" target="Code" class="method-signature"
            onclick="popupCode('Trader.src/M000134.html');return false;">
          <span class="method-name">rating</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <ul>
<li>@return [Integer]: the average <a href="Trader.html#M000134">rating</a> of
the user

</li>
</ul>
        </div>
      </div>

      <div id="method-M000132" class="method-detail">
        <a name="M000132"></a>

        <div class="method-heading">
          <a href="Trader.src/M000132.html" target="Code" class="method-signature"
            onclick="popupCode('Trader.src/M000132.html');return false;">
          <span class="method-name">remove_from_wishlist</span><span class="method-args">(offer)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000135" class="method-detail">
        <a name="M000135"></a>

        <div class="method-heading">
          <a href="Trader.src/M000135.html" target="Code" class="method-signature"
            onclick="popupCode('Trader.src/M000135.html');return false;">
          <span class="method-name">remove_offer</span><span class="method-args">(offer)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Removes an item from the owner&#8216;s list
</p>
        </div>
      </div>

      <div id="method-M000114" class="method-detail">
        <a name="M000114"></a>

        <div class="method-heading">
          <a href="Trader.src/M000114.html" target="Code" class="method-signature"
            onclick="popupCode('Trader.src/M000114.html');return false;">
          <span class="method-name">save</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Saves the trader to the trader list. Access the list with the <a
href="Trader.html#M000125">get_all</a> method.
</p>
        </div>
      </div>

      <div id="method-M000139" class="method-detail">
        <a name="M000139"></a>

        <div class="method-heading">
          <a href="Trader.src/M000139.html" target="Code" class="method-signature"
            onclick="popupCode('Trader.src/M000139.html');return false;">
          <span class="method-name">unwatch</span><span class="method-args">(trader)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>

      <div id="method-M000138" class="method-detail">
        <a name="M000138"></a>

        <div class="method-heading">
          <a href="Trader.src/M000138.html" target="Code" class="method-signature"
            onclick="popupCode('Trader.src/M000138.html');return false;">
          <span class="method-name">watch</span><span class="method-args">(trader)</span>
          </a>
        </div>
      
        <div class="method-description">
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>